{
  "/index.html": "<html>\r\n    <head>\r\n        <title>Excel Navigate Helper</title>\r\n        <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n        <script src=\"https://cdn.datatables.net/2.0.8/js/dataTables.js\"></script>\r\n        <link href=\"https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css\" rel=\"stylesheet\">\r\n        \r\n      <script type=\"module\"> (function(){const s=document.createElement(\"link\").relList;if(s&&s.supports&&s.supports(\"modulepreload\"))return;for(const t of document.querySelectorAll('link[rel=\"modulepreload\"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type===\"childList\")for(const a of e.addedNodes)a.tagName===\"LINK\"&&a.rel===\"modulepreload\"&&c(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin===\"use-credentials\"?e.credentials=\"include\":t.crossOrigin===\"anonymous\"?e.credentials=\"omit\":e.credentials=\"same-origin\",e}function c(t){if(t.ep)return;t.ep=!0;const e=n(t);fetch(t.href,e)}})();const h={checkResult:async function(o,s,n){return await i(\"checkResult\",arguments)},getWindows:async function(){return await i(\"getWindows\",arguments)},launchExcel:async function(){return await i(\"launchExcel\",arguments)},getActiveExcelRow:async function(){return await i(\"getActiveExcelRow\",arguments)},closeBackend:async function(){return await i(\"closeBackend\",arguments)}};async function i(o,...s){const n=window.location.protocol,c=window.location.hostname,e=new URLSearchParams(window.location.search).get(\"apiPort\")||\"22311\";return await(await fetch(`${n}//${c}:${e}/api?cmd=${o}&args=${encodeURIComponent(JSON.stringify(s))}`)).json()}let p=null,m=null,f={},g=!0;function w(o,s){f={},s.split(`\n`).forEach(n=>{const c=n.split(\":\");c.length>=2&&(f[c[0].trim()]=c.slice(1).join(\":\").trim())})}async function y(o,s=!1){const n=await h.getActiveExcelRow();if(!s&&m&&JSON.stringify(m)===JSON.stringify(n))return;m=n,p&&p.remove();const c=document.createElement(\"table\");c.classList.add(\"table\",\"table-bordered\"),o.appendChild(c);const t=document.createElement(\"tbody\");c.appendChild(t),t.style.whiteSpace=\"pre-wrap\";for(let e=0;e<n.data.length;e++){if(n.headings[e].trim()===\"\"&&n.data[e].trim()===\"\")continue;const a=document.createElement(\"tr\");t.appendChild(a);const l=document.createElement(\"td\");l.style.fontWeight=\"bold\",a.appendChild(l),l.textContent=n.headings[e]||\"\",g||(l.style.display=\"none\");const r=document.createElement(\"td\");a.appendChild(r);const x=f[n.headings[e]];r.style.cssText=x||\"\";const d=n.data[e];if(d.startsWith(\"http\")){const u=document.createElement(\"a\");u.href=d,u.textContent=d,r.appendChild(u)}else r.textContent=n.data[e]}p=c}async function b(){const o=document.createElement(\"div\");document.body.appendChild(o);const s=document.createElement(\"div\");s.classList.add(\"alert\",\"alert-info\"),s.innerText=`This app keep sync with Excel and show the data in current(active) row so that you can see all columns without scrolling if there are too many columns.\nIt assume there is a heading row in Excel and use the heading as the first column in the table. `,o.appendChild(s);const n=document.createElement(\"button\");n.classList.add(\"btn\",\"btn-primary\"),n.style.marginRight=\"10px\",n.textContent=\"Launch Excel to open file\",n.onclick=async()=>{await h.launchExcel()},o.append(n);const c=document.createElement(\"button\");c.classList.add(\"btn\",\"btn-secondary\"),c.style.marginRight=\"10px\",c.textContent=\"Edit Style\",o.append(c),c.onclick=()=>{const l=document.getElementById(\"styleText\");l&&(l.style.display=l.style.display===\"none\"?\"block\":\"none\")};const t=document.createElement(\"button\");t.classList.add(\"btn\",\"btn-secondary\"),t.style.marginRight=\"10px\",t.textContent=\"Toggle Heading\",o.append(t),t.onclick=()=>{g=!g,y(o,!0)};const e=document.createElement(\"button\");e.classList.add(\"btn\",\"btn-danger\"),e.textContent=\"Close\",e.onclick=async()=>{await h.closeBackend(),window.close()},o.append(e);const a=document.createElement(\"textarea\");a.classList.add(\"form-control\"),a.id=\"styleText\",a.style.width=\"100%\",a.style.height=\"200px\",a.style.display=\"none\",a.style.marginTop=\"10px\",a.style.fontFamily=\"monospace\",a.value=localStorage.getItem(\"styleText\")||\"\",o.appendChild(a),a.onkeydown=()=>{const l=a.value;w(o,l),y(o,!0),localStorage.setItem(\"styleText\",l)},w(o,a.value),o.appendChild(document.createElement(\"p\")),setInterval(y,1e3,o)}document.addEventListener(\"DOMContentLoaded\",function(){b()},!1);\n </script>\n    </head>\r\n    <body style=\"padding:10px;\">\r\n    </body>\r\n</html>\r\n",
  "/index2.html": "<html>\r\n    <head>\r\n        <title>Excel Navigate Helper</title>\r\n        <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n        <script src=\"https://cdn.datatables.net/2.0.8/js/dataTables.js\"></script>\r\n        <link href=\"https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css\" rel=\"stylesheet\">\r\n        \r\n      <script type=\"module\"> (function(){const s=document.createElement(\"link\").relList;if(s&&s.supports&&s.supports(\"modulepreload\"))return;for(const t of document.querySelectorAll('link[rel=\"modulepreload\"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type===\"childList\")for(const a of e.addedNodes)a.tagName===\"LINK\"&&a.rel===\"modulepreload\"&&c(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin===\"use-credentials\"?e.credentials=\"include\":t.crossOrigin===\"anonymous\"?e.credentials=\"omit\":e.credentials=\"same-origin\",e}function c(t){if(t.ep)return;t.ep=!0;const e=n(t);fetch(t.href,e)}})();const h={checkResult:async function(o,s,n){return await i(\"checkResult\",arguments)},getWindows:async function(){return await i(\"getWindows\",arguments)},launchExcel:async function(){return await i(\"launchExcel\",arguments)},getActiveExcelRow:async function(){return await i(\"getActiveExcelRow\",arguments)},closeBackend:async function(){return await i(\"closeBackend\",arguments)}};async function i(o,...s){const n=window.location.protocol,c=window.location.hostname,e=new URLSearchParams(window.location.search).get(\"apiPort\")||\"22311\";return await(await fetch(`${n}//${c}:${e}/api?cmd=${o}&args=${encodeURIComponent(JSON.stringify(s))}`)).json()}let p=null,m=null,f={},g=!0;function w(o,s){f={},s.split(`\n`).forEach(n=>{const c=n.split(\":\");c.length>=2&&(f[c[0].trim()]=c.slice(1).join(\":\").trim())})}async function y(o,s=!1){const n=await h.getActiveExcelRow();if(!s&&m&&JSON.stringify(m)===JSON.stringify(n))return;m=n,p&&p.remove();const c=document.createElement(\"table\");c.classList.add(\"table\",\"table-bordered\"),o.appendChild(c);const t=document.createElement(\"tbody\");c.appendChild(t),t.style.whiteSpace=\"pre-wrap\";for(let e=0;e<n.data.length;e++){if(n.headings[e].trim()===\"\"&&n.data[e].trim()===\"\")continue;const a=document.createElement(\"tr\");t.appendChild(a);const l=document.createElement(\"td\");l.style.fontWeight=\"bold\",a.appendChild(l),l.textContent=n.headings[e]||\"\",g||(l.style.display=\"none\");const r=document.createElement(\"td\");a.appendChild(r);const x=f[n.headings[e]];r.style.cssText=x||\"\";const d=n.data[e];if(d.startsWith(\"http\")){const u=document.createElement(\"a\");u.href=d,u.textContent=d,r.appendChild(u)}else r.textContent=n.data[e]}p=c}async function b(){const o=document.createElement(\"div\");document.body.appendChild(o);const s=document.createElement(\"div\");s.classList.add(\"alert\",\"alert-info\"),s.innerText=`This app keep sync with Excel and show the data in current(active) row so that you can see all columns without scrolling if there are too many columns.\nIt assume there is a heading row in Excel and use the heading as the first column in the table. `,o.appendChild(s);const n=document.createElement(\"button\");n.classList.add(\"btn\",\"btn-primary\"),n.style.marginRight=\"10px\",n.textContent=\"Launch Excel to open file\",n.onclick=async()=>{await h.launchExcel()},o.append(n);const c=document.createElement(\"button\");c.classList.add(\"btn\",\"btn-secondary\"),c.style.marginRight=\"10px\",c.textContent=\"Edit Style\",o.append(c),c.onclick=()=>{const l=document.getElementById(\"styleText\");l&&(l.style.display=l.style.display===\"none\"?\"block\":\"none\")};const t=document.createElement(\"button\");t.classList.add(\"btn\",\"btn-secondary\"),t.style.marginRight=\"10px\",t.textContent=\"Toggle Heading\",o.append(t),t.onclick=()=>{g=!g,y(o,!0)};const e=document.createElement(\"button\");e.classList.add(\"btn\",\"btn-danger\"),e.textContent=\"Close\",e.onclick=async()=>{await h.closeBackend(),window.close()},o.append(e);const a=document.createElement(\"textarea\");a.classList.add(\"form-control\"),a.id=\"styleText\",a.style.width=\"100%\",a.style.height=\"200px\",a.style.display=\"none\",a.style.marginTop=\"10px\",a.style.fontFamily=\"monospace\",a.value=localStorage.getItem(\"styleText\")||\"\",o.appendChild(a),a.onkeydown=()=>{const l=a.value;w(o,l),y(o,!0),localStorage.setItem(\"styleText\",l)},w(o,a.value),o.appendChild(document.createElement(\"p\")),setInterval(y,1e3,o)}document.addEventListener(\"DOMContentLoaded\",function(){b()},!1);\n </script>\n    </head>\r\n    <body style=\"padding:10px;\">\r\n    </body>\r\n</html>\r\n",
  "excel.js": "// deno-lint-ignore-file no-var no-inner-declarations\r\n\r\nfunction WriteTextFile (text, path, encoding) {\r\n    var stream = new ActiveXObject('ADODB.Stream');\r\n    stream.Type = 2;\r\n    stream.Mode = 3;\r\n    if (encoding) stream.Charset = encoding;\r\n    stream.Open();\r\n    stream.Position = 0;\r\n    stream.WriteText(text);\r\n    stream.SaveToFile(path, 2);\r\n    stream.Close();\r\n}\r\n\r\nfunction saveActiveRow(excel, path) {\r\n    var sheet = excel.ActiveSheet;\r\n    if (sheet) {\r\n        // get max column that have data\r\n        var maxColumn = Math.min(sheet.UsedRange.Columns.Count, 100);\r\n        // get active range\r\n        var cell = excel.ActiveCell;\r\n        if (cell) {\r\n                var activeRow = cell.Row;\r\n                var rowValues = []\r\n                var headings = []\r\n                for (var i = 1; i <= maxColumn; i++) {\r\n                    var value = sheet.Cells(activeRow, i).Value;\r\n                    rowValues.push(value);\r\n                    var heading = sheet.Cells(1, i).Value;\r\n                    headings.push(heading);\r\n                }\r\n                \r\n                var headingsStr = headings.join('_@@HS@@_');\r\n                var rowValuesStr = rowValues.join('_@@VS@@_');\r\n                var content = [headingsStr, rowValuesStr].join('_@@RS@@_');\r\n                WScript.Echo(content);\r\n                WriteTextFile(content, path, 'utf-8');\r\n        }\r\n    }\r\n}\r\n\r\nvar excel = new ActiveXObject('Excel.Application');\r\nexcel.Visible = true;\r\n\r\nvar path = WScript.Arguments(0);\r\n\r\n// for test, open a workbook\r\n// excel.Workbooks.Open('d:\\\\src\\\\excelview\\\\test.xlsx');\r\n\r\nfor (;;) {\r\n    try {\r\n        saveActiveRow(excel, path);\r\n    } catch (e) {\r\n        WScript.Echo(e.message);\r\n    }\r\n\r\n    WScript.Sleep(1000);\r\n}\r\n"
}